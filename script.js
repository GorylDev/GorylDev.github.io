const perfumeDatabase=[{id:1,name:"Midnight Rose",brand:"Maison Lumi\xE8re",notes:["rose","jasmine","sandalwood","vanilla","musk"],occasions:["evening","romantic","date","formal"],description:"An intoxicating blend of Bulgarian rose and jasmine, anchored by warm sandalwood and sensual musk. Perfect for romantic evenings.",image:"https://images.unsplash.com/photo-1592945403244-b3fbafd7f539?auto=format&fit=crop&w=500&q=60",altText:"Elegant dark red perfume bottle with romantic rose gold accents against moody background"},{id:2,name:"Citrus Dawn",brand:"Azure Fragrances",notes:["bergamot","lemon","grapefruit","neroli","white musk"],occasions:["daily","office","casual","daytime","fresh"],description:"A vibrant awakening of Italian citrus notes with a clean white musk base. Your everyday confidence booster.",image:"https://images.unsplash.com/photo-1541643600914-78b084683601?auto=format&fit=crop&w=500&q=60",altText:"Fresh bright yellow-toned perfume bottle with citrus and white musk aesthetic"},{id:3,name:"Leather & Oak",brand:"Noir Collection",notes:["leather","oakmoss","tobacco","amber","cedarwood"],occasions:["evening","business","formal","sophisticated","club"],description:"A powerful masculine composition of rich leather and smoky tobacco, grounded in woody amber and cedarwood.",image:"https://images.unsplash.com/photo-1595425970377-c9703cf48b6d?auto=format&fit=crop&w=500&q=60",altText:"Sophisticated dark brown and black perfume bottle with masculine woody leather tones"},{id:4,name:"Lavender Fields",brand:"Provence Naturals",notes:["lavender","sage","vetiver","tonka bean","coumarin"],occasions:["relaxation","evening","casual","daily"],description:"Transport yourself to the purple hills of Provence. Calming lavender meets earthy vetiver in this serene composition.",image:"https://images.unsplash.com/photo-1615634260167-c8cdede054de?auto=format&fit=crop&w=500&q=60",altText:"Serene purple and lavender-toned perfume bottle with natural botanical elements"},{id:5,name:"Sweet Amber Dream",brand:"Velvet Scents",notes:["amber","vanilla","honey","patchouli","benzoin"],occasions:["date","evening","romantic","cozy","sweet"],description:"A gourmand masterpiece blending golden amber with creamy vanilla and sweet honey. Irresistibly warm and comforting.",image:"https://images.unsplash.com/photo-1590736969955-71cc94901144?auto=format&fit=crop&w=500&q=60",altText:"Luxurious golden amber perfume bottle with warm honey and vanilla color palette"},{id:6,name:"Ocean Breeze",brand:"Aqua Essence",notes:["sea salt","marine","driftwood","sage","ambergris"],occasions:["summer","beach","casual","daytime","fresh"],description:"Capture the essence of a coastal morning. Fresh sea salt mingles with aromatic sage and weathered driftwood.",image:"https://images.unsplash.com/photo-1585386959984-a4155224a1ad?auto=format&fit=crop&w=500&q=60",altText:"Fresh aquatic blue and clear glass perfume bottle with ocean and marine aesthetic"},{id:7,name:"Spiced Oud",brand:"Orient Luxe",notes:["oud","saffron","cardamom","rose","leather"],occasions:["evening","formal","luxury","special","exotic"],description:"An opulent oriental fragrance featuring rare oud wood, precious saffron, and warm spices. Pure luxury.",image:"https://images.unsplash.com/photo-1600857062241-98e5e6bad62b?auto=format&fit=crop&w=500&q=60",altText:"Opulent deep red and gold oriental perfume bottle with exotic spice elements"},{id:8,name:"Green Tea Garden",brand:"Zen Botanicals",notes:["green tea","bergamot","jasmine","white musk","bamboo"],occasions:["daily","office","meditation","daytime","fresh"],description:"A refreshing blend of Japanese green tea and delicate jasmine. Clean, crisp, and effortlessly elegant.",image:"https://images.unsplash.com/photo-1594035910387-fea47794261f?auto=format&fit=crop&w=500&q=60",altText:"Minimalist green and white perfume bottle with zen garden and tea aesthetic"},{id:9,name:"Wild Cherry Blossom",brand:"Sakura House",notes:["cherry blossom","peach","rose","musk","sandalwood"],occasions:["spring","romantic","daytime","feminine","sweet"],description:"Delicate cherry blossoms dance with juicy peach and soft rose petals. Femininity in its purest form.",image:"https://images.unsplash.com/photo-1587556930900-4c4fc0e0d643?auto=format&fit=crop&w=500&q=60",altText:"Delicate pink and peach-toned perfume bottle with cherry blossom feminine aesthetic"},{id:10,name:"Dark Chocolate & Rum",brand:"Gourmand Gallery",notes:["dark chocolate","rum","coffee","vanilla","tonka bean"],occasions:["evening","club","winter","cozy","sweet"],description:"An indulgent dessert-inspired scent. Rich dark chocolate swirled with aged rum and espresso notes.",image:"https://images.unsplash.com/photo-1610457047076-cd71cca79dd4?auto=format&fit=crop&w=500&q=60",altText:"Rich dark brown and chocolate-toned perfume bottle with gourmand dessert aesthetic"}];class SearchEngine{constructor(a){this.database=a,this.weights={noteMatch:3,occasionMatch:2,multiMatch:1.5}}parseQuery(a){return a&&"string"==typeof a?a.toLowerCase().split(/[,;\s]+/).map(a=>a.trim()).filter(a=>0<a.length):[]}calculateScore(a,b){let c=0;const d=new Set,e=new Set;b.forEach(b=>{a.notes.forEach(a=>{(a.toLowerCase().includes(b)||b.includes(a.toLowerCase()))&&(c+=this.weights.noteMatch,d.add(a))}),a.occasions.forEach(a=>{(a.toLowerCase().includes(b)||b.includes(a.toLowerCase()))&&(c+=this.weights.occasionMatch,e.add(a))}),a.name.toLowerCase().includes(b)&&(c+=1),a.brand.toLowerCase().includes(b)&&(c+=1)});const f=d.size+e.size;return 1<f&&(c*=1+.1*(f-1)),{score:c,matchedNotes:Array.from(d),matchedOccasions:Array.from(e)}}search(a){const b=this.parseQuery(a);if(0===b.length)return[];const c=this.database.map(a=>{const c=this.calculateScore(a,b);return{...a,score:c.score,matchedNotes:c.matchedNotes,matchedOccasions:c.matchedOccasions,matchPercentage:Math.min(100,Math.round(100*(c.score/(b.length*this.weights.noteMatch))))}}).filter(a=>0<a.score).sort((c,a)=>a.score-c.score);return c}}class UIController{constructor(){this.elements={searchForm:document.getElementById("searchForm"),searchInput:document.getElementById("searchInput"),resultsGrid:document.getElementById("resultsGrid"),resultsHeader:document.getElementById("resultsHeader"),resultsCount:document.getElementById("resultsCount"),loadingState:document.getElementById("loadingState"),emptyState:document.getElementById("emptyState"),suggestionChips:document.querySelectorAll(".suggestion-chip"),themeToggle:document.getElementById("themeToggle")},this.state={isLoading:!1,currentResults:[],theme:localStorage.getItem("theme")||"light"},this.initializeEventListeners(),this.initializeTheme()}initializeEventListeners(){this.elements.searchForm.addEventListener("submit",a=>{a.preventDefault(),this.handleSearch()}),this.elements.suggestionChips.forEach(a=>{a.addEventListener("click",()=>{const b=a.dataset.query;this.elements.searchInput.value=b,this.handleSearch()})}),this.elements.themeToggle.addEventListener("click",()=>{this.toggleTheme()})}initializeTheme(){document.documentElement.setAttribute("data-theme",this.state.theme)}toggleTheme(){this.state.theme="light"===this.state.theme?"dark":"light",document.documentElement.setAttribute("data-theme",this.state.theme),localStorage.setItem("theme",this.state.theme)}showLoading(){this.state.isLoading=!0,this.elements.loadingState.hidden=!1,this.elements.resultsHeader.hidden=!0,this.elements.emptyState.hidden=!0,this.elements.resultsGrid.innerHTML=""}hideLoading(){this.state.isLoading=!1,this.elements.loadingState.hidden=!0}showEmptyState(){this.elements.emptyState.hidden=!1,this.elements.resultsHeader.hidden=!0,this.elements.resultsGrid.innerHTML=""}renderResults(a){if(this.state.currentResults=a,0===a.length)return void this.showEmptyState();this.elements.resultsCount.textContent=a.length,this.elements.resultsHeader.hidden=!1,this.elements.emptyState.hidden=!0;const b=a.map(a=>this.createPerfumeCard(a)).join("");this.elements.resultsGrid.innerHTML=b,this.elements.resultsGrid.scrollIntoView({behavior:"smooth",block:"start"})}createPerfumeCard(a){return`
        <article class="perfume-card" role="article" aria-label="${a.name} by ${a.brand}">
            <div class="card-image-wrapper">
                <img 
                    src="${a.image}" 
                    alt="${this.escapeHtml(a.altText||a.name)}" 
                    class="card-image"
                    loading="lazy"
                    onerror="this.onerror=null; this.src='${"https://placehold.co/600x400/1a1a1a/D4AF37?text=Luxury+Perfume&font=source-serif-pro"}';"
                >
                <div class="match-score" aria-label="Match score">
                    ${a.matchPercentage}% Match
                </div>
            </div>
            
            <div class="card-content">
                <div class="card-brand">${this.escapeHtml(a.brand)}</div>
                <h4 class="card-name">${this.escapeHtml(a.name)}</h4>
                <p class="card-description">${this.escapeHtml(a.description)}</p>
                
                <div class="card-meta">
                    <div class="card-notes">
                        <span class="meta-label">Notes:</span>
                        ${a.notes.map(b=>`<span class="tag ${a.matchedNotes.includes(b)?"highlight":""}">${this.escapeHtml(b)}</span>`).join("")}
                    </div>
                    
                    <div class="card-occasions">
                        <span class="meta-label">Best for:</span>
                        ${a.occasions.map(b=>`<span class="tag ${a.matchedOccasions.includes(b)?"highlight":""}">${this.escapeHtml(b)}</span>`).join("")}
                    </div>
                </div>
            </div>
        </article>
    `}escapeHtml(a){const b=document.createElement("div");return b.textContent=a,b.innerHTML}handleSearch(){const a=this.elements.searchInput.value.trim();a&&(this.showLoading(),setTimeout(()=>{const b=app.searchEngine.search(a);this.hideLoading(),this.renderResults(b)},500))}}class App{constructor(){this.searchEngine=new SearchEngine(perfumeDatabase),this.uiController=new UIController,console.log("\uD83C\uDF38 Essence Finder initialized successfully"),console.log(`ðŸ“Š Database loaded: ${perfumeDatabase.length} perfumes`)}search(a){this.uiController.elements.searchInput.value=a,this.uiController.handleSearch()}}let app;"loading"===document.readyState?document.addEventListener("DOMContentLoaded",initializeApp):initializeApp();function initializeApp(){try{app=new App,window.essenceFinder=app}catch(a){console.error("Failed to initialize Essence Finder:",a);const b=document.createElement("div");b.style.cssText=`
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: #fff;
            padding: 2rem;
            border-radius: 8px;
            box-shadow: 0 4px 16px rgba(0,0,0,0.1);
            text-align: center;
            max-width: 400px;
        `,b.innerHTML=`
            <h3 style="margin-bottom: 1rem; color: #c92a2a;">Initialization Error</h3>
            <p style="margin-bottom: 1rem; color: #666;">Sorry, something went wrong. Please refresh the page.</p>
            <button onclick="location.reload()" style="padding: 0.5rem 1rem; background: #8B7355; color: white; border: none; border-radius: 4px; cursor: pointer;">
                Refresh Page
            </button>
        `,document.body.appendChild(b)}}
